<li>
  <section class="relation">
    {% if rel.node.guid and rel.node.name %}
      <a href="{{ rel.node.guid }}" class="event" target="_blank">
        {{ rel.node.name }}
      </a>
    {% else %}
      <p class="event">{{ rel.node.name }}</p>
    {% endif %}

    {% assign type = rel.node.type | default: rel.node.type_en | default: rel.node.type_nl | downcase %}

    {% case type %}
      {% when "person" %}
        {% assign text = rel.node.bio_en | default: rel.node.bio_nl %}

      {% when "organisation" %}
        {% assign text = rel.node.about_en | default: rel.node.about_nl %}

      {% when "event" %}
      {% when "launch" %}
      {% when "exhibition" %}
      {% when "review" %}
        {% assign text = rel.node.content_en | default: rel.node.content_nl %}
    {% endcase %}

    {% if text %}
      <p>{{ text | strip_html | truncate: 300 }}</p>
    {% endif %}

    {% if rel.rels and rel.rels.size > 0 %}
      <details class="skiplink rel">
        <summary>Laat {{ rel.rels.size }} relaties zien</summary>
        <ul class="relation-relation">
          {% for subrel in rel.rels %}
            {% assign relNode = subrel.node | default: subrel.object %}
            {% assign title = relNode.title_en | default: relNode.title_nl %}
            {% if title == nil or title == "" %}
              {% assign displayText = relNode.name %}
            {% else %}
              {% assign displayText = title %}
            {% endif %}
            {% if displayText %}
              <li>
                <p class="{{ subrel.type | downcase }} rel">{{ displayText }}</p>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      </details>
    {% endif %}

    {% if rel.node.year %}
      <div class="hapje">
        <time class="year rel" datetime="{{ rel.node.year }}-01-01">
          {{ rel.node.year }}
        </time>
      </div>
    {% endif %}
  </section>
</li>